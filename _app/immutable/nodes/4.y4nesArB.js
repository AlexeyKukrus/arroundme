import"../chunks/DsnmJJEf.js";import{i as E}from"../chunks/ClUBSYe8.js";import{p as S,o as k,G as f,H as w,I as c,a as M,s as i,J as l,K as p,M as v,O,f as m,Q as x}from"../chunks/Bsas3Ui_.js";import{s as I,i as P,a as D}from"../chunks/BQsonRgg.js";import{g as J}from"../chunks/0j5r99M7.js";import{p as j}from"../chunks/CJfNFG2g.js";import{E as z}from"../chunks/s1iccJ2c.js";var A=f('<div class="loader svelte-lkl612">Загрузка...</div>'),B=f('<div class="event-form-page svelte-lkl612"><h1 class="svelte-lkl612"> </h1> <!></div>');function R(u,h){S(h,!1);const[g,y]=D(),n=I(j,"$page",g).params.id,s=!!n;let d=l({name:"",address:"",coordinates:"",scheduledFor:"",description:"",activityType:"party"}),a=l(!1);k(()=>{const e={event:{name:"Party",description:"Amazing party",activityType:"party",address:"123 Main St",coordinates:"55.125324|25.155324",scheduledFor:"2025-08-11T18:00:00Z"}};i(d,{name:e.event.name,address:e.event.address,coordinates:e.event.coordinates,scheduledFor:e.event.scheduledFor.slice(0,16),description:e.event.description,activityType:e.event.activityType})});const _=async e=>{try{i(a,!0);const t=s?`/api/v1/events/${n}`:"/api/v1/events";if(!(await fetch(t,{method:s?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,scheduledFor:new Date(e.scheduledFor).toISOString()})})).ok)throw new Error("Ошибка сохранения события");await J("/events")}catch(t){console.error("Ошибка:",t),alert(t instanceof Error?t.message:"Не удалось сохранить событие")}finally{i(a,!1)}};E();var o=B(),r=p(o),T=p(r,!0);v(r);var $=O(r,2);{var F=e=>{var t=A();c(e,t)},b=e=>{z(e,{get initialData(){return m(d)},get isEditMode(){return s},$$events:{submit:_}})};P($,e=>{m(a)&&s?e(F):e(b,!1)})}v(o),w(()=>x(T,s?"РЕДАКТИРОВАТЬ СОБЫТИЕ":"СОЗДАТЬ СОБЫТИЕ")),c(u,o),M(),y()}export{R as component};
